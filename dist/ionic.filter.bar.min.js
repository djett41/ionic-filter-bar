angular.module("jett.ionic.filter.bar",["ionic"]),function(e){"use strict";e.module("jett.ionic.filter.bar").directive("ionFilterBar",["$document","$timeout","$ionicGesture","$ionicPlatform",function(t,n,r,o){var i;return i=o.is("android")?'<div class="filter-bar-wrapper filter-bar-{{::config.theme}} filter-bar-transition-{{::config.transition}}"><div class="bar bar-header bar-{{::config.theme}} item-input-inset"><button class="filter-bar-cancel button button-icon icon {{::config.back}}"></button><label class="item-input-wrapper"><input type="search" class="filter-bar-search" ng-model="filterText" placeholder="{{::config.placeholder}}" /><button style="display:none;" class="filter-bar-clear button button-icon icon {{::config.clear}}"></button></label></div></div>':'<div class="filter-bar-wrapper filter-bar-{{::config.theme}} filter-bar-transition-{{::config.transition}}"><div class="bar bar-header bar-{{::config.theme}} item-input-inset"><label class="item-input-wrapper"><i class="icon {{::config.search}} placeholder-icon"></i><input type="search" class="filter-bar-search" ng-model="filterText" placeholder="{{::config.placeholder}}"/><button style="display:none;" class="filter-bar-clear button button-icon icon {{::config.clear}}"></button></label><button class="filter-bar-cancel button button-clear" ng-bind-html="::cancelText"></button></div></div>',{restrict:"E",scope:!0,link:function(o,i){var c,a,l,s,f,u=e.element(i[0].querySelector(".filter-bar-clear")),d=e.element(i[0].querySelector(".filter-bar-cancel")),p=i.find("input");o.filterText="";var b=function(){o.cancelFilterBar()};d.bind("click",b),o.config.backdrop&&o.focusOnShow&&(l=e.element('<div class="filter-bar-backdrop"></div>'),i.append(l),s=function(e){e.target==l[0]&&b()},l.bind("click",s),a=r.on("swipe",s,l));var m=function(){"none"===u.css("display")&&u.css("display","block")},h=function(){"block"===u.css("display")&&u.css("display","none")},g=function(){n(function(){o.filterText="",h(),ionic.requestAnimationFrame(function(){o.showBackdrop(),o.scrollItemsTop(),o.focusInput()})})};u.bind("touchstart mousedown",g),p.bind("touchstart mousedown",function(){o.scrollItemsTop(),o.focusInput()});var v=function(e){27==e.which?b():o.filterText&&o.filterText.length?(m(),o.hideBackdrop()):(h(),o.showBackdrop())};t.bind("keyup",v);var B=function(){o.filterItems(o.filterText)};o.$on("$destroy",function(){i.remove(),t.unbind("keyup",v),l&&r.off(a,"swipe",s),f()}),f=o.$watch("filterText",function(e,t){var r;c&&n.cancel(c),e!==t&&(r=e.length&&o.debounce?o.delay:0,c=n(B,r,!1))})},template:i}}])}(angular),function(e){"use strict";e.module("jett.ionic.filter.bar").provider("$ionicFilterBarConfig",function(){function t(e,t){a.platform[e]=t,i.platform[e]={},n(a,a.platform[e]),r(a.platform[e],i.platform[e],"")}function n(t,r){for(var o in t)o!=c&&t.hasOwnProperty(o)&&(e.isObject(t[o])?(e.isDefined(r[o])||(r[o]={}),n(t[o],r[o])):e.isDefined(r[o])||(r[o]=null))}function r(t,n,i){e.forEach(t,function(l,s){e.isObject(t[s])?(n[s]={},r(t[s],n[s],i+"."+s)):n[s]=function(e){if(arguments.length)return t[s]=e,n;if(t[s]==c){var r=o(a.platform,ionic.Platform.platform()+i+"."+s);return r||r===!1?r:o(a.platform,"default"+i+"."+s)}return t[s]}})}function o(t,n){n=n.split(".");for(var r=0;r<n.length;r++){if(!t||!e.isDefined(t[n[r]]))return null;t=t[n[r]]}return t}var i=this;i.platform={};var c="platform",a={theme:c,clear:c,search:c,backdrop:c,transition:c,platform:{},placeholder:c};r(a,i,""),t("default",{clear:"ion-ios-close",search:"ion-ios-search-strong",backdrop:!0,transition:"vertical",placeholder:"Search"}),t("ios",{}),t("android",{clear:"ion-android-close",search:!1,backdrop:!1,transition:"horizontal"}),i.setPlatformConfig=t,i.$get=function(){return i}})}(angular),function(e,t){"use strict";var n=function(e){var t=["light","stable","positive","calm","balanced","energized","assertive","royal","dark"],n=e&&e.classList;if(n)for(var r=0;r<t.length;r++)if(n.contains("bar-"+t[r]))return t[r]};e.module("jett.ionic.filter.bar").factory("$ionicFilterBar",["$document","$rootScope","$compile","$timeout","$filter","$ionicPlatform","$ionicFilterBarConfig","$ionicConfig","$ionicScrollDelegate",function(r,o,i,c,a,l,s,f,u){function d(r){if(!p){p=!0,r=r||{};var s=o.$new(!0),f=!1,d=!1;r.container&&(r.container=e.element(b[0].querySelector(r.container))),e.extend(s,{config:m,$deregisterBackButton:e.noop,update:e.noop,cancel:e.noop,done:e.noop,scrollDelegate:u,filter:a("filter"),filterProperties:null,expression:null,comparator:null,debounce:!0,delay:300,cancelText:"Cancel",cancelOnStateChange:!0,container:b,focusOnShow:!0},r),s.config.theme||(s.config.theme=n(s.container[0].querySelector(".bar.bar-header")));var h=s.element=i('<ion-filter-bar class="filter-bar"></ion-filter-bar>')(s),g=h.children().eq(0),v=g.find("input")[0],B=h.children().eq(1),k=s.scrollDelegate.getScrollView(),$=!!k,y=$?e.element(k.__container):null,w=s.cancelOnStateChange?o.$on("$stateChangeSuccess",function(){s.cancelFilterBar()}):e.noop,T=function(){d||(d=!0,v&&v.focus())},F=function(){d&&(d=!1,v&&v.blur())},x=function(){k.__scrollTop>0&&F()};return s.scrollItemsTop=function(){$&&s.scrollDelegate.scrollTop&&s.scrollDelegate.scrollTop()},s.focusInput=function(){d=!1,T()},s.hideBackdrop=function(){B.length&&f&&(f=!1,B.removeClass("active").css("display","none"))},s.showBackdrop=function(){B.length&&!f&&(f=!0,B.css("display","block").addClass("active"))},s.filterItems=function(t){var n,r;t.length?(s.expression?n=e.bind(this,s.expression,t):e.isArray(s.filterProperties)?(n={},e.forEach(s.filterProperties,function(e){n[e]=t})):s.filterProperties?(n={},n[s.filterProperties]=t):n=t,r=s.filter(s.items,n,s.comparator)):r=s.items,c(function(){s.update(r,t),s.scrollItemsTop()})},s.$deregisterBackButton=l.registerBackButtonAction(function(){c(s.cancelFilterBar)},300),s.removeFilterBar=function(n){s.removed||(s.removed=!0,t.requestAnimationFrame(function(){g.removeClass("filter-bar-in"),F(),s.hideBackdrop(),c(function(){s.scrollItemsTop(),s.update(s.items),s.$destroy(),h.remove(),s.cancelFilterBar.$scope=y=k=g=B=v=null,p=!1,(n||e.noop)()},350)}),c(function(){s.container.removeClass("filter-bar-open")},400),s.$deregisterBackButton(),w(),y&&y.off("scroll",x))},s.showFilterBar=function(n){s.removed||(s.container.append(h).addClass("filter-bar-open"),s.scrollItemsTop(),t.requestAnimationFrame(function(){s.removed||c(function(){g.addClass("filter-bar-in"),s.focusOnShow&&(s.focusInput(),s.showBackdrop()),(n||e.noop)()},20,!1)}),y&&y.on("scroll",x))},s.cancelFilterBar=function(){s.removeFilterBar(s.cancel)},s.showFilterBar(s.done),s.cancelFilterBar.$scope=s,s.cancelFilterBar}}var p=!1,b=e.element(r[0].body),m={theme:s.theme(),transition:s.transition(),back:f.backButton.icon(),clear:s.clear(),search:s.search(),backdrop:s.backdrop(),placeholder:s.placeholder()};return{show:d}}])}(angular,ionic);