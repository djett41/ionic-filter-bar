angular.module("jett.ionic.filter.bar",["ionic"]),function(e){"use strict";e.module("jett.ionic.filter.bar").directive("ionFilterBar",["$document","$timeout","$ionicGesture","$ionicPlatform",function(t,n,r,i){var o;return o=i.is("android")?'<div class="filter-bar-wrapper filter-bar-{{::config.theme}} filter-bar-transition-{{::config.transition}}"><div class="bar bar-header bar-{{::config.theme}} item-input-inset"><button class="filter-bar-cancel button button-icon icon {{::config.back}}"></button><label class="item-input-wrapper"><input type="search" class="filter-bar-search" ng-model="filterText" placeholder="Search" /><button style="display:none;" class="filter-bar-clear button button-icon icon {{::config.clear}}"></button></label></div></div>':'<div class="filter-bar-wrapper filter-bar-{{::config.theme}} filter-bar-transition-{{::config.transition}}"><div class="bar bar-header bar-{{::config.theme}} item-input-inset"><label class="item-input-wrapper"><i class="icon {{::config.search}} placeholder-icon"></i><input type="search" class="filter-bar-search" ng-model="filterText" placeholder="Search"/><button style="display:none;" class="filter-bar-clear button button-icon icon {{::config.clear}}"></button></label><button class="filter-bar-cancel button button-clear" ng-bind-html="::cancelText"></button></div></div>',{restrict:"E",scope:!0,link:function(i,o){var c,a,l,s,f=e.element(o[0].querySelector(".filter-bar-clear")),u=e.element(o[0].querySelector(".filter-bar-cancel")),p=o.find("input");i.filterText="";var d=function(){i.cancelFilterBar()};u.bind("click",d),i.config.backdrop&&(l=e.element('<div class="filter-bar-backdrop"></div>'),o.append(l),s=function(e){e.target==l[0]&&d()},l.bind("click",s),a=r.on("swipe",s,l));var b=function(){"none"===f.css("display")&&f.css("display","block")},m=function(){"block"===f.css("display")&&f.css("display","none")},h=function(){n(function(){i.filterText="",m(),ionic.requestAnimationFrame(function(){i.showBackdrop(),i.scrollItemsTop(),i.focusInput()})})};f.bind("touchstart mousedown",h),p.bind("touchstart mousedown",function(){i.scrollItemsTop(),i.focusInput()});var g=function(e){27==e.which?d():i.filterText&&i.filterText.length?(b(),i.hideBackdrop()):(m(),i.showBackdrop())};t.bind("keyup",g);var v=function(){i.filterItems(i.filterText)};i.$on("$destroy",function(){o.remove(),t.unbind("keyup",g),l&&r.off(a,"swipe",s)}),i.$watch("filterText",function(e,t){var r;c&&n.cancel(c),e!==t&&(r=e.length&&i.debounce?i.delay:0,c=n(v,r,!1))})},template:o}}])}(angular),function(e){"use strict";e.module("jett.ionic.filter.bar").provider("$ionicFilterBarConfig",function(){function t(e,t){a.platform[e]=t,o.platform[e]={},n(a,a.platform[e]),r(a.platform[e],o.platform[e],"")}function n(t,r){for(var i in t)i!=c&&t.hasOwnProperty(i)&&(e.isObject(t[i])?(e.isDefined(r[i])||(r[i]={}),n(t[i],r[i])):e.isDefined(r[i])||(r[i]=null))}function r(t,n,o){e.forEach(t,function(l,s){e.isObject(t[s])?(n[s]={},r(t[s],n[s],o+"."+s)):n[s]=function(e){if(arguments.length)return t[s]=e,n;if(t[s]==c){var r=i(a.platform,ionic.Platform.platform()+o+"."+s);return r||r===!1?r:i(a.platform,"default"+o+"."+s)}return t[s]}})}function i(t,n){n=n.split(".");for(var r=0;r<n.length;r++){if(!t||!e.isDefined(t[n[r]]))return null;t=t[n[r]]}return t}var o=this;o.platform={};var c="platform",a={theme:c,clear:c,search:c,backdrop:c,transition:c,platform:{}};r(a,o,""),t("default",{theme:"positive",clear:"ion-ios-close",search:"ion-ios-search-strong",backdrop:!0,transition:"vertical"}),t("ios",{}),t("android",{theme:"positive",clear:"ion-android-close",search:!1,backdrop:!1,transition:"horizontal"}),o.setPlatformConfig=t,o.$get=function(){return o}})}(angular),function(e){"use strict";e.module("jett.ionic.filter.bar").factory("$ionicFilterBar",["$rootScope","$compile","$timeout","$filter","$ionicPlatform","$ionicFilterBarConfig","$ionicConfig","$ionicBody","$ionicScrollDelegate",function(t,n,r,i,o,c,a,l,s){function f(c){if(!u){u=!0,c=c||{};var a=t.$new(!0),f=!1,d=!1;e.extend(a,{config:p,$deregisterBackButton:e.noop,update:e.noop,cancel:e.noop,done:e.noop,scrollDelegate:s,filter:i("filter"),filterProperties:null,debounce:!0,delay:300,cancelText:"Cancel",cancelOnStateChange:!0},c);var b,m=a.element=n('<ion-filter-bar class="filter-bar"></ion-filter-bar>')(a),h=m.children().eq(0),g=h.find("input")[0],v=m.children().eq(1),B=a.scrollDelegate.getScrollView(),k=!!B;k&&(b=e.element(B.__container));var $=a.cancelOnStateChange?t.$on("$stateChangeSuccess",function(){a.cancelFilterBar()}):e.noop,y=function(){d||(d=!0,g&&g.focus())},w=function(){d&&(d=!1,g&&g.blur())},T=function(){B.__scrollTop>0&&w()};return a.scrollItemsTop=function(){k&&a.scrollDelegate.scrollTop&&a.scrollDelegate.scrollTop()},a.focusInput=function(){d=!1,y()},a.hideBackdrop=function(){v.length&&f&&(f=!1,v.removeClass("active").css("display","none"))},a.showBackdrop=function(){v.length&&!f&&(f=!0,v.css("display","block").addClass("active"))},a.filterItems=function(t){var n,i;t.length?(e.isArray(a.filterProperties)?(n={},e.forEach(a.filterProperties,function(e){n[e]=t})):a.filterProperties?(n={},n[a.filterProperties]=t):n=t,i=a.filter(a.items,n)):i=a.items,r(function(){a.update(i),a.scrollItemsTop()})},a.$deregisterBackButton=o.registerBackButtonAction(function(){r(a.cancelFilterBar)},300),a.removeFilterBar=function(t){a.removed||(a.removed=!0,ionic.requestAnimationFrame(function(){h.removeClass("filter-bar-in"),w(),a.hideBackdrop(),r(function(){a.scrollItemsTop(),a.update(a.items),a.$destroy(),m.remove(),a.cancelFilterBar.$scope=b=B=h=v=g=null,u=!1,(t||e.noop)()},350)}),r(function(){l.removeClass("filter-bar-open")},400),a.$deregisterBackButton(),$(),k&&b.off("scroll",T))},a.showFilterBar=function(t){a.removed||(l.append(m).addClass("filter-bar-open"),a.scrollItemsTop(),ionic.requestAnimationFrame(function(){a.removed||r(function(){h.addClass("filter-bar-in"),a.focusInput(),a.showBackdrop(),(t||e.noop)()},20,!1)}),k&&b.on("scroll",T))},a.cancelFilterBar=function(){a.removeFilterBar(a.cancel)},a.showFilterBar(a.done),a.cancelFilterBar.$scope=a,a.cancelFilterBar}}var u=!1,p={theme:c.theme(),transition:c.transition(),back:a.backButton.icon(),clear:c.clear(),search:c.search(),backdrop:c.backdrop()};return{show:f}}])}(angular);