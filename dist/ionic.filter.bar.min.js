angular.module("jett.ionic.filter.bar",["ionic"]),function(e){"use strict";e.module("jett.ionic.filter.bar").directive("ionFilterBar",["$document","$timeout","$ionicGesture","$ionicPlatform",function(t,n,r,i){var o;return o=i.is("android")?'<div class="filter-bar-wrapper filter-bar-{{::config.theme}} filter-bar-transition-{{::config.transition}}"><div class="bar bar-header bar-{{::config.theme}} item-input-inset"><button class="filter-bar-cancel button button-icon icon {{::config.back}}"></button><label class="item-input-wrapper"><input type="search" class="filter-bar-search" ng-model="filterText" placeholder="Search" /><button style="display:none;" class="filter-bar-clear button button-icon icon {{::config.clear}}"></button></label></div></div>':'<div class="filter-bar-wrapper filter-bar-{{::config.theme}} filter-bar-transition-{{::config.transition}}"><div class="bar bar-header bar-{{::config.theme}} item-input-inset"><label class="item-input-wrapper"><i class="icon {{::config.search}} placeholder-icon"></i><input type="search" class="filter-bar-search" ng-model="filterText" placeholder="Search"/><button style="display:none;" class="filter-bar-clear button button-icon icon {{::config.clear}}"></button></label><button class="filter-bar-cancel button button-clear" ng-bind-html="::cancelText"></button></div></div>',{restrict:"E",scope:!0,link:function(i,o){var a,c,l,s,f=e.element(o[0].querySelector(".filter-bar-clear")),u=e.element(o[0].querySelector(".filter-bar-cancel")),d=o.find("input");i.filterText="";var p=function(){i.cancelFilterBar()};u.bind("click",p),i.config.backdrop&&(l=e.element('<div class="filter-bar-backdrop"></div>'),o.append(l),s=function(e){e.target==l[0]&&p()},l.bind("click",s),c=r.on("swipe",s,l));var b=function(){"none"===f.css("display")&&f.css("display","block")},m=function(){"block"===f.css("display")&&f.css("display","none")},h=function(){n(function(){i.filterText="",m(),ionic.requestAnimationFrame(function(){i.showBackdrop(),i.scrollItemsTop(),i.focusInput()})})};f.bind("touchstart mousedown",h),d.bind("touchstart mousedown",function(){i.scrollItemsTop(),i.focusInput()});var g=function(e){27==e.which?p():i.filterText&&i.filterText.length?(b(),i.hideBackdrop()):(m(),i.showBackdrop())};t.bind("keyup",g);var v=function(){i.filterItems(i.filterText)};i.$on("$destroy",function(){o.remove(),t.unbind("keyup",g),l&&r.off(c,"swipe",s)}),i.$watch("filterText",function(e,t){var r;a&&n.cancel(a),e!==t&&(r=e.length&&i.debounce?i.delay:0,a=n(v,r,!1))})},template:o}}])}(angular),function(e){"use strict";e.module("jett.ionic.filter.bar").provider("$ionicFilterBarConfig",function(){function t(e,t){c.platform[e]=t,o.platform[e]={},n(c,c.platform[e]),r(c.platform[e],o.platform[e],"")}function n(t,r){for(var i in t)i!=a&&t.hasOwnProperty(i)&&(e.isObject(t[i])?(e.isDefined(r[i])||(r[i]={}),n(t[i],r[i])):e.isDefined(r[i])||(r[i]=null))}function r(t,n,o){e.forEach(t,function(l,s){e.isObject(t[s])?(n[s]={},r(t[s],n[s],o+"."+s)):n[s]=function(e){if(arguments.length)return t[s]=e,n;if(t[s]==a){var r=i(c.platform,ionic.Platform.platform()+o+"."+s);return r||r===!1?r:i(c.platform,"default"+o+"."+s)}return t[s]}})}function i(t,n){n=n.split(".");for(var r=0;r<n.length;r++){if(!t||!e.isDefined(t[n[r]]))return null;t=t[n[r]]}return t}var o=this;o.platform={};var a="platform",c={theme:a,clear:a,search:a,backdrop:a,transition:a,platform:{}};r(c,o,""),t("default",{clear:"ion-ios-close",search:"ion-ios-search-strong",backdrop:!0,transition:"vertical"}),t("ios",{}),t("android",{clear:"ion-android-close",search:!1,backdrop:!1,transition:"horizontal"}),o.setPlatformConfig=t,o.$get=function(){return o}})}(angular),function(e){"use strict";var t=function(e){var t=["light","stable","positive","calm","balanced","energized","assertive","royal","dark"],n=e&&e.classList;if(n)for(var r=0;r<t.length;r++)if(n.contains("bar-"+t[r]))return t[r]};e.module("jett.ionic.filter.bar").factory("$ionicFilterBar",["$rootScope","$compile","$timeout","$filter","$ionicPlatform","$ionicFilterBarConfig","$ionicConfig","$ionicBody","$ionicScrollDelegate",function(n,r,i,o,a,c,l,s,f){function u(t){if(!d){d=!0,t=t||{};var c=n.$new(!0),l=!1,u=!1;e.extend(c,{config:p,$deregisterBackButton:e.noop,update:e.noop,cancel:e.noop,done:e.noop,scrollDelegate:f,filter:o("filter"),filterProperties:null,debounce:!0,delay:300,cancelText:"Cancel",cancelOnStateChange:!0},t);var b,m=c.element=r('<ion-filter-bar class="filter-bar"></ion-filter-bar>')(c),h=m.children().eq(0),g=h.find("input")[0],v=m.children().eq(1),B=c.scrollDelegate.getScrollView(),k=!!B;k&&(b=e.element(B.__container));var $=c.cancelOnStateChange?n.$on("$stateChangeSuccess",function(){c.cancelFilterBar()}):e.noop,y=function(){u||(u=!0,g&&g.focus())},w=function(){u&&(u=!1,g&&g.blur())},T=function(){B.__scrollTop>0&&w()};return c.scrollItemsTop=function(){k&&c.scrollDelegate.scrollTop&&c.scrollDelegate.scrollTop()},c.focusInput=function(){u=!1,y()},c.hideBackdrop=function(){v.length&&l&&(l=!1,v.removeClass("active").css("display","none"))},c.showBackdrop=function(){v.length&&!l&&(l=!0,v.css("display","block").addClass("active"))},c.filterItems=function(t){var n,r;t.length?(e.isArray(c.filterProperties)?(n={},e.forEach(c.filterProperties,function(e){n[e]=t})):c.filterProperties?(n={},n[c.filterProperties]=t):n=t,r=c.filter(c.items,n)):r=c.items,i(function(){c.update(r),c.scrollItemsTop()})},c.$deregisterBackButton=a.registerBackButtonAction(function(){i(c.cancelFilterBar)},300),c.removeFilterBar=function(t){c.removed||(c.removed=!0,ionic.requestAnimationFrame(function(){h.removeClass("filter-bar-in"),w(),c.hideBackdrop(),i(function(){c.scrollItemsTop(),c.update(c.items),c.$destroy(),m.remove(),c.cancelFilterBar.$scope=b=B=h=v=g=null,d=!1,(t||e.noop)()},350)}),i(function(){s.removeClass("filter-bar-open")},400),c.$deregisterBackButton(),$(),k&&b.off("scroll",T))},c.showFilterBar=function(t){c.removed||(s.append(m).addClass("filter-bar-open"),c.scrollItemsTop(),ionic.requestAnimationFrame(function(){c.removed||i(function(){h.addClass("filter-bar-in"),c.focusInput(),c.showBackdrop(),(t||e.noop)()},20,!1)}),k&&b.on("scroll",T))},c.cancelFilterBar=function(){c.removeFilterBar(c.cancel)},c.showFilterBar(c.done),c.cancelFilterBar.$scope=c,c.cancelFilterBar}}var d=!1,p={theme:c.theme()||t(s.get().querySelector(".nav-bar-container")),transition:c.transition(),back:l.backButton.icon(),clear:c.clear(),search:c.search(),backdrop:c.backdrop()};return{show:u}}])}(angular);